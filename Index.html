<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaxNaija - Nigeria 2026 Tax Calculator & Tracker</title>
    <meta name="description" content="Nigeria's smartest tax calculator. Track monthly, plan annually, stay compliant with 2026 tax laws.">
    <!-- jsPDF for PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- SheetJS for Excel export -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #006B3D;
            --primary-dark: #004D2C;
            --secondary: #F7B32B;
            --accent: #2A9D8F;
            --danger: #E63946;
            --text-dark: #1A1A2E;
            --text-light: #6C757D;
            --bg-light: #F8F9FA;
            --white: #FFFFFF;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            background: var(--bg-light);
        }

        /* Navigation */
        .navbar {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            padding: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.8em;
            font-weight: 900;
            color: var(--white);
            text-decoration: none;
        }

        .logo span {
            color: var(--secondary);
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            align-items: center;
        }

        .nav-link {
            color: var(--white);
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s;
        }

        .nav-link:hover {
            color: var(--secondary);
        }

        .btn-nav {
            padding: 10px 25px;
            background: var(--secondary);
            color: var(--primary-dark);
            border: none;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s;
        }

        .btn-nav:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(247, 179, 43, 0.4);
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            padding: 80px 20px;
            text-align: center;
        }

        .hero h1 {
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 1.3em;
            margin-bottom: 30px;
            opacity: 0.95;
        }

        .hero-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-primary {
            padding: 15px 40px;
            background: var(--secondary);
            color: var(--primary-dark);
            border: none;
            border-radius: 30px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(247, 179, 43, 0.4);
        }

        .btn-secondary {
            padding: 15px 40px;
            background: transparent;
            color: var(--white);
            border: 2px solid var(--white);
            border-radius: 30px;
            font-size: 1.2em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-secondary:hover {
            background: var(--white);
            color: var(--primary);
        }

        /* Features Section */
        .features {
            max-width: 1200px;
            margin: 80px auto;
            padding: 0 20px;
        }

        .features h2 {
            text-align: center;
            font-size: 2.5em;
            color: var(--primary);
            margin-bottom: 50px;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 40px;
        }

        .feature-card {
            background: var(--white);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .feature-icon {
            font-size: 3em;
            margin-bottom: 20px;
        }

        .feature-card h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        /* Auth Pages */
        .auth-page {
            display: none;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .auth-page.active {
            display: flex;
        }

        .auth-container {
            max-width: 500px;
            margin: auto;
            background: var(--white);
            padding: 50px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }

        .auth-container h2 {
            color: var(--primary);
            margin-bottom: 30px;
            text-align: center;
            font-size: 2em;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #E0E0E0;
            border-radius: 10px;
            font-size: 1em;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 107, 61, 0.1);
        }

        .btn-auth {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: var(--white);
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .btn-auth:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 107, 61, 0.3);
        }

        .auth-divider {
            text-align: center;
            margin: 30px 0;
            color: var(--text-light);
            position: relative;
        }

        .auth-divider::before,
        .auth-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: #E0E0E0;
        }

        .auth-divider::before {
            left: 0;
        }

        .auth-divider::after {
            right: 0;
        }

        .social-login {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }

        .btn-social {
            flex: 1;
            padding: 12px;
            border: 2px solid #E0E0E0;
            background: var(--white);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-social:hover {
            border-color: var(--primary);
            background: var(--bg-light);
        }

        .auth-link {
            text-align: center;
            margin-top: 20px;
            color: var(--text-light);
        }

        .auth-link a {
            color: var(--primary);
            font-weight: 600;
            text-decoration: none;
        }

        .auth-link a:hover {
            text-decoration: underline;
        }

        /* Dashboard */
        .dashboard {
            display: none;
            min-height: 100vh;
            padding: 40px 20px;
        }

        .dashboard.active {
            display: block;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .dashboard-header {
            background: var(--white);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .dashboard-header h2 {
            color: var(--primary);
            font-size: 2em;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-avatar {
            width: 50px;
            height: 50px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            font-weight: 700;
            color: var(--primary-dark);
        }

        .btn-logout {
            padding: 10px 25px;
            background: var(--danger);
            color: var(--white);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-logout:hover {
            background: #D62828;
        }

        /* Calculator Modes */
        .calculator-modes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .mode-card {
            background: var(--white);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
        }

        .mode-card:hover {
            transform: translateY(-3px);
            border-color: var(--primary);
        }

        .mode-card.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, #F0FFF4 0%, #E8F5E9 100%);
        }

        .mode-card h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.4em;
        }

        .mode-card p {
            color: var(--text-light);
        }

        /* Calculator Section */
        .calculator-section {
            background: var(--white);
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .section-title {
            color: var(--primary);
            font-size: 1.6em;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--secondary);
        }

        .calc-method-toggle {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .method-btn {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            border: 2px solid var(--primary);
            background: var(--white);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .method-btn.active {
            background: var(--primary);
            color: var(--white);
        }

        .method-btn:hover {
            transform: translateY(-2px);
        }

        /* Results */
        .results-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }

        .result-box {
            background: linear-gradient(135deg, #F0FFF4 0%, #E8F5E9 100%);
            padding: 30px;
            border-radius: 15px;
            border: 3px solid var(--accent);
        }

        .result-box h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid rgba(0,0,0,0.1);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            font-weight: 600;
        }

        .result-value {
            font-weight: 700;
            color: var(--primary);
        }

        .total-tax-box {
            background: var(--secondary);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin: 20px 0;
        }

        .total-tax-box .label {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .total-tax-box .amount {
            font-size: 2.5em;
            font-weight: 900;
            color: var(--primary-dark);
        }

        /* Alert Box */
        .alert {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .alert-warning {
            background: #FFF3CD;
            border: 2px solid #FFC107;
            color: #856404;
        }

        .alert-info {
            background: #D1ECF1;
            border: 2px solid #17A2B8;
            color: #0C5460;
        }

        .alert-success {
            background: #D4EDDA;
            border: 2px solid #28A745;
            color: #155724;
        }

        /* Monthly Tracker */
        .month-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .month-btn {
            padding: 15px;
            border: 2px solid #E0E0E0;
            background: var(--white);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            text-align: center;
        }

        .month-btn:hover {
            border-color: var(--primary);
        }

        .month-btn.active {
            background: var(--primary);
            color: var(--white);
            border-color: var(--primary);
        }

        .month-btn.completed {
            background: var(--accent);
            color: var(--white);
            border-color: var(--accent);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }

        .stat-card {
            background: var(--white);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            border-left: 5px solid var(--primary);
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: 900;
            color: var(--primary);
            margin: 10px 0;
        }

        .stat-label {
            color: var(--text-light);
            font-size: 0.95em;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2em;
            }

            .nav-menu {
                flex-direction: column;
                gap: 15px;
            }

            .auth-container {
                padding: 30px;
            }

            .results-comparison {
                grid-template-columns: 1fr;
            }

            .calculator-modes {
                grid-template-columns: 1fr;
            }

        /* ==================== ENHANCED RESPONSIVE DESIGN ==================== */

        /* Burger Menu */
            .burger-menu {
                display: none;
                flex-direction: column;
                gap: 5px;
                cursor: pointer;
                padding: 10px;
                z-index: 1001;
            }

            .burger-menu span {
                width: 25px;
                height: 3px;
                background: var(--white);
                border-radius: 3px;
                transition: all 0.3s;
            }

        /* FX Converter Card */
            .fx-converter-card {
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                padding: 25px;
                border-radius: 12px;
                margin: 20px 0;
                color: var(--white);
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            }

            .fx-input-group {
                display: grid;
                grid-template-columns: 1fr auto 1fr;
                gap: 15px;
                align-items: end;
                margin-top: 15px;
            }

            .fx-input-wrapper {
                position: relative;
            }

            .fx-input-wrapper label {
                display: block;
                font-size: 0.9em;
                margin-bottom: 5px;
                opacity: 0.9;
            }

            .fx-input-wrapper input {
                width: 100%;
                padding: 12px;
                border: 2px solid rgba(255,255,255,0.3);
                border-radius: 8px;
                background: rgba(255,255,255,0.1);
                color: var(--white);
                font-size: 1em;
                font-weight: 600;
            }

            .fx-input-wrapper input::placeholder {
                color: rgba(255,255,255,0.5);
            }

            .fx-swap-icon {
                font-size: 1.8em;
                opacity: 0.8;
                align-self: end;
                padding-bottom: 12px;
            }

            .fx-rate-display {
                margin-top: 15px;
                padding: 12px;
                background: rgba(0,0,0,0.2);
                border-radius: 6px;
                text-align: center;
                font-size: 0.9em;
            }

            .fx-rate-badge {
                display: inline-block;
                padding: 4px 10px;
                background: rgba(255,255,255,0.2);
                border-radius: 12px;
                font-size: 0.85em;
                margin-left: 10px;
            }

        /* Export Buttons */
            .export-buttons {
                display: flex;
                gap: 15px;
                flex-wrap: wrap;
                justify-content: center;
                margin-top: 25px;
            }

            .btn-export {
                padding: 12px 30px;
                background: var(--accent);
                color: var(--white);
                border: none;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s;
                font-size: 0.95em;
            }

            .btn-export:hover {
                background: #238276;
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(42, 157, 143, 0.3);
            }

        /* Danger Button */
            .btn-danger {
                background: var(--danger);
                color: var(--white);
                border: none;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                transition: all 0.3s;
                padding: 12px 30px;
            }

            .btn-danger:hover {
                background: #d32f2f;
                transform: translateY(-2px);
                box-shadow: 0 4px 12px rgba(230, 57, 70, 0.3);
            }

        /* Tax Calendar */
            .tax-calendar {
                background: var(--white);
                padding: 30px;
                border-radius: 12px;
                margin: 30px 0;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            }

            .calendar-grid {
                display: grid ;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 20px;
                margin-top: 20px;
            }

            .calendar-item {
                padding: 20px;
                background: var(--bg-light);
                border-radius: 8px;
                text-align: center;
                transition: all 0.3s;
            }

            .calendar-item:hover {
                transform: translateY(-3px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }

            .countdown-timer {
                margin-top: 25px;
                padding: 20px;
                background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
                border-radius: 8px;
                text-align: center;
                color: var(--white);
            }

        /* Enhanced Mobile Responsive */
            @media (max-width: 768px) {
                /* Navigation */
                .burger-menu {
                    display: flex;
                }
                
                .nav-menu {
                    position: fixed;
                    top: 60px;
                    right: -100%;
                    width: 280px;
                    height: calc(100vh - 60px);
                    background: var(--primary-dark);
                    flex-direction: column;
                    padding: 30px 20px;
                    gap: 20px;
                    transition: right 0.3s;
                    box-shadow: -2px 0 10px rgba(0,0,0,0.3);
                    z-index: 999;
                    overflow-y: auto;
                }
                
                .nav-menu.active {
                    right: 0;
                }
                
                .burger-menu.active span:nth-child(1) {
                    transform: rotate(45deg) translate(8px, 8px);
                }
                
                .burger-menu.active span:nth-child(2) {
                    opacity: 0;
                }
                
                .burger-menu.active span:nth-child(3) {
                    transform: rotate(-45deg) translate(8px, -8px);
                }
                
            /* Hero Section */
                .hero {
                    padding: 60px 20px;
                }
                
                .hero h1 {
                    font-size: 1.8em;
                }
                
                .hero p {
                    font-size: 1.1em;
                }
                
                .hero-buttons {
                    flex-direction: column;
                    width: 100%;
                }
                
                .btn-primary, .btn-secondary {
                    width: 100%;
                    max-width: 300px;
                }
                
            /* Features */
                .features-grid {
                    grid-template-columns: 1fr;
                    gap: 20px;
                }
                
            /* Auth Forms */
                .auth-container {
                    padding: 25px;
                    margin: 20px;
                }
                
            /* Calculator Modes */
                .calculator-modes {
                    grid-template-columns: 1fr;
                }
                
                .mode-card {
                    padding: 20px;
                }
                
            /* Results */
                .results-comparison {
                    grid-template-columns: 1fr;
                }
                
                .result-box {
                    margin-bottom: 20px;
                }
                
            /* Month Selector */
                .month-selector {
                    grid-template-columns: repeat(2, 1fr);
                    gap: 10px;
                }
                
                .month-btn {
                    padding: 10px;
                    font-size: 0.9em;
                }
                
            /* Stats Grid */
                .stats-grid {
                    grid-template-columns: 1fr;
                    gap: 15px;
                }
                
            /* FX Converter Mobile */
                .fx-input-group {
                    grid-template-columns: 1fr;
                    gap: 15px;
                }
                
                .fx-swap-icon {
                    transform: rotate(90deg);
                    padding: 0;
                    margin: -10px 0;
                }
                
            /* Calendar Grid Mobile */
                .calendar-grid {
                    grid-template-columns: 1fr;
                    gap: 15px;
                }
                
            /* Export Buttons Mobile */
                .export-buttons {
                    flex-direction: column;
                    align-items: stretch;
                }
                
                .btn-export {
                    width: 100%;
                }
                
            /* Tables */
                .result-item {
                    font-size: 0.9em;
                }
                
                .total-tax-box {
                    padding: 20px;
                }
            }

            /* Tablet Responsive (768px - 1024px) */
            @media (min-width: 769px) and (max-width: 1024px) {
                .features-grid {
                    grid-template-columns: repeat(2, 1fr);
                }
                
                .calculator-modes {
                    grid-template-columns: repeat(2, 1fr);
                }
                
                .month-selector {
                    grid-template-columns: repeat(4, 1fr);
                }
                
                .calendar-grid {
                    grid-template-columns: repeat(2, 1fr);
                }
            }

            /* Small Mobile (max 480px) */
            @media (max-width: 480px) {
                .hero h1 {
                    font-size: 1.5em;
                }
                
                .logo {
                    font-size: 1.5em;
                }
                
                .nav-container {
                    padding: 0 15px;
                }
                
                .auth-container {
                    padding: 20px;
                    margin: 15px;
                }
                
                .form-group input,
                .form-group select {
                    font-size: 16px; /* Prevents zoom on mobile */
                }
                
                .stat-value {
                    font-size: 1.8em;
                }
                
                .btn-auth,
                .btn-danger,
                .btn-export {
                    padding: 12px 20px;
                    font-size: 0.95em;
                }
            }
        }

        .hidden {
            display: none !important;
        }

        /* Loading Spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: var(--white);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo" onclick="showHome()">Tax<span>Naija</span></a>
            
            <!-- Burger Menu (Mobile) -->
            <div class="burger-menu" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </div>
            
            <div class="nav-menu" id="navMenu">
                <a href="#" class="nav-link" onclick="showHome()">Home</a>
                <a href="#features" class="nav-link">Features</a>
                <a href="#" class="nav-link" id="navAuthLink" onclick="showLogin()">Login</a>
                <a href="#" class="btn-nav" id="navCTABtn" onclick="showSignup()">Get Started</a>
            </div>
        </div>
    </nav>

    <!-- Home Page -->
    <div id="homePage">
        <!-- Hero Section -->
        <section class="hero">
            <h1>üá≥üá¨ Nigeria's Smartest Tax Calculator</h1>
            <p>Track monthly. Plan annually. Stay compliant with 2026 tax laws.</p>
            <div class="hero-buttons">
                <button class="btn-primary" onclick="showSignup()">Start Free Trial</button>
                <button class="btn-secondary" onclick="showQuickCalc()">Quick Calculate</button>
            </div>
        </section>

        <!-- Features Section -->
        <section class="features" id="features">
            <h2>Why Choose TaxNaija?</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üìä</div>
                    <h3>Dual Calculation</h3>
                    <p>See both tax methods side-by-side. Know your exact liability under any scenario.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìÖ</div>
                    <h3>Monthly Tracking</h3>
                    <p>Track income month-by-month. Know exactly what to save for March 2027 filing.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üí∞</div>
                    <h3>Smart Projections</h3>
                    <p>Based on your actual performance, see projected annual tax and monthly targets.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîí</div>
                    <h3>Secure & Private</h3>
                    <p>Your financial data encrypted and stored securely. Multi-device sync.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üì±</div>
                    <h3>Works Everywhere</h3>
                    <p>Phone, tablet, computer. Access your data anywhere, anytime.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚úÖ</div>
                    <h3>Always Updated</h3>
                    <p>We monitor FIRS updates. You always have the latest accurate information.</p>
                </div>
            </div>
        </section>
    </div>

    <!-- Login Page -->
    <div id="loginPage" class="auth-page">
        <div class="auth-container">
            <h2>Welcome Back!</h2>
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="loginEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="loginPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <button type="submit" class="btn-auth">Login</button>
            </form>
            
            <div class="auth-divider">OR</div>
            
            <div class="social-login">
                <button class="btn-social" onclick="loginWithGoogle()">
                    <span>üîç</span> Google
                </button>
                <button class="btn-social" onclick="alert('Facebook login coming soon!')">
                    <span>üìò</span> Facebook
                </button>
            </div>
            
            <div class="auth-link">
                Don't have an account? <a href="#" onclick="showSignup()">Sign up</a>
            </div>
        </div>
    </div>

    <!-- Signup Page -->
    <div id="signupPage" class="auth-page">
        <div class="auth-container">
            <h2>Start Your Free Trial</h2>
            <p style="text-align: center; color: var(--text-light); margin-bottom: 20px;">
                7 days free, then ‚Ç¶2,000/month
            </p>
            <form id="signupForm" onsubmit="handleSignup(event)">
                <div class="form-group">
                    <label>Full Name</label>
                    <input type="text" id="signupName" required placeholder="John Doe">
                </div>
                <div class="form-group">
                    <label>Email Address</label>
                    <input type="email" id="signupEmail" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" id="signupPassword" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6">
                </div>
                <div class="form-group">
                    <label>Business Type</label>
                    <select id="signupBusinessType" style="width: 100%; padding: 15px; border: 2px solid #E0E0E0; border-radius: 10px; font-size: 1em;">
                        <option value="trader">Trader/Business Owner</option>
                        <option value="salary">Salary Earner</option>
                        <option value="pos">POS Operator</option>
                        <option value="freelancer">Freelancer</option>
                        <option value="remote">Remote Workers (USD Income)</option>
                        <option value="company">Company</option>
                    </select>
                </div>
                <button type="submit" class="btn-auth">Create Account</button>
            </form>
            
            <div class="auth-divider">OR</div>
            
            <div class="social-login">
                <button class="btn-social" onclick="signupWithGoogle()">
                    <span>üîç</span> Google
                </button>
                <button class="btn-social" onclick="alert('Facebook signup coming soon!')">
                    <span>üìò</span> Facebook
                </button>
            </div>
            
            <div class="auth-link">
                Already have an account? <a href="#" onclick="showLogin()">Login</a>
            </div>
        </div>
    </div>

    <!-- Dashboard -->
    <div id="dashboardPage" class="dashboard">
        <div class="dashboard-container">
            <!-- Dashboard Header -->
            <div class="dashboard-header">
                <div>
                    <h2>Welcome back, <span id="userName">User</span>! üëã</h2>
                    <p style="color: var(--text-light);">Track your tax. Stay compliant. Save money.</p>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">U</div>
                    <button class="btn-logout" onclick="handleLogout()">Logout</button>
                </div>
            </div>

            <!-- Tax Info Alert -->
            <div class="alert alert-info">
                <strong>‚ÑπÔ∏è 2026 Tax Reform Update</strong><br>
                CRA (Consolidated Relief Allowance) has been eliminated. The first ‚Ç¶800,000 of income is now tax-free (0% bracket). 
                All calculations use the new progressive tax system.
            </div>

            <!-- Calculator Mode Selection -->
            <div class="calculator-modes">
                <div class="mode-card active" id="annualMode" onclick="selectMode('annual')">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">üìä</div>
                    <h3>Annual Calculator</h3>
                    <p>Know your total annual income? Get instant tax calculation.</p>
                </div>
                <div class="mode-card" id="monthlyMode" onclick="selectMode('monthly')">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">üìÖ</div>
                    <h3>Monthly Tracker</h3>
                    <p>Track month-by-month. See running totals and projections.</p>
                </div>
                <div class="mode-card" id="payeMode" onclick="selectMode('paye')">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">üíº</div>
                    <h3>PAYE Calculator</h3>
                    <p>Salary earners & remote workers: See monthly PAYE breakdown.</p>
                    <div style="margin-top: 10px; padding: 5px 10px; background: rgba(247, 179, 43, 0.2); border-radius: 5px; font-size: 0.85em; color: var(--primary);">
                        Remote Workers & Salary Earners
                    </div>
                </div>
                <div class="mode-card" id="plannerMode" onclick="selectMode('planner')">
                    <div style="font-size: 2.5em; margin-bottom: 10px;">üéØ</div>
                    <h3>Smart Planner</h3>
                    <p>Plan ahead with monthly savings targets for the year.</p>
                </div>
            </div>


            <!-- Tax Calendar -->
            <div class="tax-calendar">
                <h3 style="color: var(--primary); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    üìÖ Important Tax Dates 2026-2027
                </h3>
                
                <div class="calendar-grid">
                    <div class="calendar-item">
                        <div style="font-size: 2em; margin-bottom: 10px;">üìå</div>
                        <div style="font-weight: 700; color: var(--primary); font-size: 1.05em;">Jan 1, 2026</div>
                        <div style="color: var(--text-light); margin-top: 5px; font-size: 0.9em;">New tax laws take effect</div>
                    </div>
                    
                    <div class="calendar-item">
                        <div style="font-size: 2em; margin-bottom: 10px;">‚è∞</div>
                        <div style="font-weight: 700; color: var(--danger); font-size: 1.05em;">Mar 31, 2027</div>
                        <div style="color: var(--text-light); margin-top: 5px; font-size: 0.9em;">Filing deadline</div>
                    </div>
                    
                    <div class="calendar-item">
                        <div style="font-size: 2em; margin-bottom: 10px;">üí∞</div>
                        <div style="font-weight: 700; color: var(--accent); font-size: 1.05em;">Quarterly</div>
                        <div style="color: var(--text-light); margin-top: 5px; font-size: 0.9em;">Apr/Jul/Oct/Jan payments</div>
                    </div>
                    
                    <div class="calendar-item">
                        <div style="font-size: 2em; margin-bottom: 10px;">üö®</div>
                        <div style="font-weight: 700; color: var(--danger); font-size: 1.05em;">Late Filing</div>
                        <div style="color: var(--text-light); margin-top: 5px; font-size: 0.9em;">‚Ç¶100k in the first month + ‚Ç¶50k subsequent month</div>
                    </div>
                </div>
                
                <!-- Countdown -->
                <div class="countdown-timer">
                    <div style="font-size: 0.9em; opacity: 0.9; margin-bottom: 5px;">Days Until Filing Deadline</div>
                    <div id="daysRemaining" style="font-size: 2.5em; font-weight: 900;">---</div>
                </div>
            </div>

            <!-- Annual Calculator -->
            <div id="annualCalculator" class="calculator-section">
                <h2 class="section-title">Annual Tax Calculator</h2>
                
                <div class="form-group">
                    <label>Annual Gross Income (‚Ç¶)</label>
                    <input type="text" id="annualIncome" oninput="formatNumberInput(this)" placeholder="5,000,000">
                </div>
                
                <div class="form-group">
                    <label>Annual Business Expenses (‚Ç¶)</label>
                    <input type="text" id="annualExpenses" oninput="formatNumberInput(this)" placeholder="5,000,000">
                    <p style="color: var(--text-light); font-size: 0.9em; margin-top: 5px;">Cost of goods, rent, salaries, etc.</p>
                </div>

                <button class="btn-auth" onclick="calculateAnnualTax()" style="width: auto; padding: 15px 50px;">
                    Calculate Tax
                </button>

                <!-- Results -->
                <div id="annualResults" class="hidden">
                    <div class="alert alert-success" style="margin-top: 30px;">
                        <strong>üìä Your 2026 Tax Calculation</strong>
                    </div>

                    <div class="result-box">
                        <h3>Your Tax Breakdown</h3>
                        
                        <div class="result-item">
                            <span class="result-label">Gross Income:</span>
                            <span class="result-value" id="calc-income">‚Ç¶0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Business Expenses:</span>
                            <span class="result-value" id="calc-expenses">‚Ç¶0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Net Profit (Taxable):</span>
                            <span class="result-value" id="calc-profit">‚Ç¶0</span>
                        </div>

                        <div class="total-tax-box" style="background: var(--primary); color: var(--white); margin-top: 20px;">
                            <div class="label">YOUR TAX FOR 2026</div>
                            <div class="amount" id="calc-tax" style="color: var(--white);">‚Ç¶0</div>
                        </div>
                    </div>

                    <!-- Export Buttons -->
                    <div class="export-buttons">
                        <button class="btn-export" onclick="exportToPDF()">
                            üìÑ Download PDF Report
                        </button>
                        <button class="btn-export" onclick="exportToExcel()">
                            üìä Export to Excel
                        </button>
                    </div>

                    <!-- Info Box -->
                    <div class="alert alert-info" style="margin-top: 30px;">
                        <strong>‚ÑπÔ∏è How This Was Calculated:</strong><br>
                        Tax is calculated progressively on your net profit:
                        <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                            <li>First ‚Ç¶800,000: <strong>0% tax</strong> (tax-free bracket)</li>
                            <li>‚Ç¶800k - ‚Ç¶3M: <strong>15% tax</strong></li>
                            <li>‚Ç¶3M - ‚Ç¶12M: <strong>18% tax</strong></li>
                            <li>‚Ç¶12M - ‚Ç¶25M: <strong>21% tax</strong></li>
                            <li>‚Ç¶25M - ‚Ç¶50M: <strong>23% tax</strong></li>
                            <li>Above ‚Ç¶50M: <strong>25% tax</strong></li>
                        </ul>
                        <br>
                        <strong>Note:</strong> CRA has been eliminated in the 2026 tax reform.
                    </div>
                </div>
            </div>

            <!-- Monthly Tracker (Hidden by default) -->
            <div id="monthlyTracker" class="calculator-section hidden">
                <h2 class="section-title">Monthly Tax Tracker 2026</h2>
                
                <div class="alert alert-info">
                    <strong>üìÖ How Monthly Tracking Works:</strong><br>
                    Enter your income and expenses for each month. We'll calculate running totals, project your annual tax, 
                    and tell you exactly how much to save each month for March 2027 filing.
                </div>

                <!-- Month Selector -->
                <h3 style="margin: 30px 0 15px 0; color: var(--primary);">Select Month:</h3>
                <div class="month-selector">
                    <button class="month-btn active" onclick="selectMonth(1)">January</button>
                    <button class="month-btn" onclick="selectMonth(2)">February</button>
                    <button class="month-btn" onclick="selectMonth(3)">March</button>
                    <button class="month-btn" onclick="selectMonth(4)">April</button>
                    <button class="month-btn" onclick="selectMonth(5)">May</button>
                    <button class="month-btn" onclick="selectMonth(6)">June</button>
                    <button class="month-btn" onclick="selectMonth(7)">July</button>
                    <button class="month-btn" onclick="selectMonth(8)">August</button>
                    <button class="month-btn" onclick="selectMonth(9)">September</button>
                    <button class="month-btn" onclick="selectMonth(10)">October</button>
                    <button class="month-btn" onclick="selectMonth(11)">November</button>
                    <button class="month-btn" onclick="selectMonth(12)">December</button>
                </div>

            <!-- FX Converter (Only for Remote Workers) -->
            <div id="fxConverterSection" class="fx-converter-card" style="display: none;">
                <h4 style="margin-bottom: 5px; display: flex; align-items: center; gap: 8px;">
                    üí± USD to NGN Converter
                    <span id="fxLoadingBadge" style="font-size: 0.75em; opacity: 0.8;"></span>
                    </h4>
                    <p style="font-size: 0.85em; opacity: 0.9; margin-bottom: 15px;">
                        Enter your USD income, we'll auto-convert to NGN using live rates
                    </p>
                    
                <div class="fx-input-group">
                    <div class="fx-input-wrapper">
                        <label>üíµ USD Income</label>
                        <input type="text" id="usdIncomeInput" oninput="formatNumberInput(this); convertUSDtoNGN()" placeholder="1,000">
                    </div>
                        
                    <div class="fx-swap-icon">‚áÑ</div>
                        
                    <div class="fx-input-wrapper">
                        <label>üí∞ NGN Equivalent</label>
                         <input type="text" id="ngnEquivalentInput" readonly placeholder="1,650,000" style="cursor: not-allowed; opacity: 0.9;">
                    </div>
                    </div>
                    
                    <div class="fx-rate-display">
                        <span>Current Rate:</span>
                        <strong style="font-size: 1.1em;">$1 = ‚Ç¶<span id="currentExchangeRate">1650</span></strong>
                        <span class="fx-rate-badge" id="rateSource">Black Market</span>
                        <button onclick="refreshExchangeRate()" style="margin-left: 10px; padding: 4px 12px; background: rgba(255,255,255,0.2); border: none; border-radius: 5px; color: white; cursor: pointer; font-size: 0.85em;">üîÑ Refresh</button>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: rgba(0,0,0,0.1); border-radius: 6px; font-size: 0.85em;">
                        üí° <strong>Tip:</strong> Use the NGN amount below in your monthly income entry
                    </div>
            </div>

                <!-- Month Entry Form -->
                <div style="background: #F8F9FA; padding: 30px; border-radius: 12px; margin: 25px 0;">
                    <h3 style="color: var(--primary); margin-bottom: 20px;">
                        <span id="currentMonthName">January</span> 2026 Entry
                    </h3>
                    
                    <div class="form-group">
                        <label>Income This Month (‚Ç¶)</label>
                        <input type="text" id="monthIncome" oninput="formatNumberInput(this)" placeholder="5,000,000">
                    </div>
                    
                    <div class="form-group">
                        <label>Expenses This Month (‚Ç¶)</label>
                        <input type="text" id="monthExpenses" oninput="formatNumberInput(this)" placeholder="5,000,000">
                    </div>

                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <button class="btn-auth" onclick="saveMonth()" style="flex: 1; min-width: 150px; padding: 12px 30px;">
                        üíæ Save <span id="currentMonthName2">January</span>
                        </button>
    
                        <button class="btn-danger" onclick="clearMonth()" style="flex: 1; min-width: 150px;">
                            üóëÔ∏è Clear Month
                        </button>
                    </div>
                </div>   

                <!-- Year-to-Date Stats -->
                <div id="ytdStats" class="hidden">
                    <h3 style="margin: 40px 0 20px 0; color: var(--primary);">üìä Year-to-Date Summary</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-label">Total Income (YTD)</div>
                            <div class="stat-value" id="ytd-income">‚Ç¶0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Total Expenses (YTD)</div>
                            <div class="stat-value" id="ytd-expenses">‚Ç¶0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Total Profit (YTD)</div>
                            <div class="stat-value" id="ytd-profit">‚Ç¶0</div>
                        </div>
                        <div class="stat-card" style="border-left-color: var(--secondary);">
                            <div class="stat-label">Tax Saved So Far</div>
                            <div class="stat-value" id="ytd-saved">‚Ç¶0</div>
                        </div>
                    </div>
                    <div class="alert alert-success" style="margin-top: 30px;">
                        <strong>üí∞ Your Action This Month:</strong><br>
                        Based on your current pace, set aside <strong id="monthly-target">‚Ç¶0</strong> this month for tax.
                        <br><br>
                        <strong>üìà Projected Annual Tax:</strong> <span id="projected-tax">‚Ç¶0</span>
                    </div>
                </div>
            </div>

            <!-- Smart Planner (Hidden by default) -->
            <div id="smartPlanner" class="calculator-section hidden">
                <h2 class="section-title">Smart Tax Planner 2026</h2>
                
                <div class="alert alert-info">
                    <strong>üéØ Plan Your Year:</strong><br>
                    Tell us what you expect to earn in 2026, and we'll create a monthly savings plan 
                    so you're ready for March 2027 tax filing.
                </div>

                <div class="form-group">
                    <label>Expected Annual Income (‚Ç¶)</label>
                    <input type="text" id="planIncome" oninput="formatNumberInput(this)" placeholder="5,000,000">
                </div>
                
                <div class="form-group">
                    <label>Expected Annual Expenses (‚Ç¶)</label>
                    <input type="text" id="planExpenses" oninput="formatNumberInput(this)" placeholder="5,000,000">
                </div>

                <button class="btn-auth" onclick="createPlan()" style="width: auto; padding: 15px 50px;">
                    Create My Plan
                </button>

                <div id="planResults" class="hidden">
                    <!-- Plan will be inserted here -->
                </div>
            </div>


            <!-- PAYE Calculator (For Remote Workers & Salary Earners Only) -->
            <div id="payeCalculator" class="calculator-section hidden">
                <h2 class="section-title">PAYE Tax Calculator</h2>
                
                <div class="alert alert-info">
                    <strong>üíº Understanding PAYE (Pay As You Earn):</strong><br>
                    PAYE is how salary earners and remote workers pay tax monthly. Your employer/client 
                    withholds tax from your salary each month. This calculator shows your monthly PAYE breakdown.
                </div>

                <!-- Business Type Check -->
                <div id="payeBusinessTypeWarning" class="alert alert-warning" style="display: none;">
                    <strong>‚ö†Ô∏è Notice:</strong> PAYE Calculator is designed for Remote Workers and Salary Earners. 
                    Your business type is: <strong id="currentBusinessType"></strong>. 
                    You may want to use the Annual Calculator instead.
                </div>

                <div class="form-group">
                    <label>Monthly Gross Salary/Income (‚Ç¶)</label>
                    <input type="text" id="payeMonthlyIncome" oninput="formatNumberInput(this)" placeholder="500,000">
                    <p style="color: var(--text-light); font-size: 0.9em; margin-top: 5px;">
                        Enter your monthly salary (before tax). For variable income, use average monthly.
                    </p>
                </div>
                
                <!-- FX Converter for Remote Workers -->
                <div id="payeFxConverter" class="fx-converter-card" style="display: none; margin: 20px 0;">
                    <h4 style="margin-bottom: 5px;">üí± USD to NGN Converter</h4>
                    <p style="font-size: 0.85em; opacity: 0.9; margin-bottom: 15px;">
                        Enter your monthly USD salary
                    </p>
                    
                    <div class="fx-input-group">
                        <div class="fx-input-wrapper">
                            <label>üíµ USD Salary</label>
                            <input type="text" id="payeUsdInput" oninput="formatNumberInput(this); convertPayeUSDtoNGN()" placeholder="3,000">
                        </div>
                        
                        <div class="fx-swap-icon">‚áÑ</div>
                        
                        <div class="fx-input-wrapper">
                            <label>üí∞ NGN Equivalent</label>
                            <input type="text" id="payeNgnOutput" readonly placeholder="4,950,000" style="cursor: not-allowed; opacity: 0.9;">
                        </div>
                    </div>
                    
                    <div class="fx-rate-display">
                        <span>Current Rate:</span>
                        <strong style="font-size: 1.1em;">$1 = ‚Ç¶<span id="payeExchangeRate">1650</span></strong>
                        <span class="fx-rate-badge" id="payeRateSource">Live Rate</span>
                    </div>
                </div>

                <button class="btn-auth" onclick="calculatePAYE()" style="width: auto; padding: 15px 50px; margin-top: 10px;">
                    Calculate PAYE
                </button>

                <!-- PAYE Results -->
                <div id="payeResults" class="hidden">
                    <div class="alert alert-success" style="margin-top: 30px;">
                        <strong>üìä Your PAYE Breakdown</strong>
                    </div>

                    <!-- Summary Cards -->
                    <div class="stats-grid" style="margin-top: 30px;">
                        <div class="stat-card">
                            <div class="stat-label">Monthly Gross Salary</div>
                            <div class="stat-value" id="paye-monthly-gross">‚Ç¶0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Monthly PAYE Tax</div>
                            <div class="stat-value" style="color: var(--danger);" id="paye-monthly-tax">‚Ç¶0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Monthly Net (Take Home)</div>
                            <div class="stat-value" style="color: var(--accent);" id="paye-monthly-net">‚Ç¶0</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Annual Tax</div>
                            <div class="stat-value" id="paye-annual-tax">‚Ç¶0</div>
                        </div>
                    </div>

                    <!-- Annual Summary -->
                    <div style="background: var(--white); padding: 30px; border-radius: 12px; margin-top: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 20px;">üìÖ Annual Summary</h3>
                        
                        <div class="result-item">
                            <span class="result-label">Annual Gross Income:</span>
                            <span class="result-value" id="paye-annual-gross">‚Ç¶0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Total PAYE Tax (12 months):</span>
                            <span class="result-value" style="color: var(--danger);" id="paye-annual-tax-2">‚Ç¶0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Annual Net Income:</span>
                            <span class="result-value" style="color: var(--accent);" id="paye-annual-net">‚Ç¶0</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Effective Tax Rate:</span>
                            <span class="result-value" id="paye-effective-rate">0%</span>
                        </div>
                    </div>

                    <!-- Monthly Breakdown Table -->
                    <div style="background: var(--white); padding: 30px; border-radius: 12px; margin-top: 30px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <h3 style="color: var(--primary); margin-bottom: 20px;">üìä Monthly PAYE Schedule (2026)</h3>
                        
                        <div style="overflow-x: auto;">
                            <table id="payeScheduleTable" style="width: 100%; border-collapse: collapse;">
                                <thead>
                                    <tr style="background: var(--bg-light);">
                                        <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Month</th>
                                        <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Gross Income</th>
                                        <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">PAYE Tax</th>
                                        <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Net Income</th>
                                    </tr>
                                </thead>
                                <tbody id="payeScheduleBody">
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                                <tfoot>
                                    <tr style="background: var(--primary); color: white; font-weight: 700;">
                                        <td style="padding: 12px; border: 1px solid #ddd;">TOTAL (12 Months)</td>
                                        <td style="padding: 12px; text-align: right; border: 1px solid #ddd;" id="paye-total-gross">‚Ç¶0</td>
                                        <td style="padding: 12px; text-align: right; border: 1px solid #ddd;" id="paye-total-tax">‚Ç¶0</td>
                                        <td style="padding: 12px; text-align: right; border: 1px solid #ddd;" id="paye-total-net">‚Ç¶0</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>

                    <!-- Info Box -->
                    <div class="alert alert-info" style="margin-top: 30px;">
                        <strong>‚ÑπÔ∏è How PAYE Works:</strong><br>
                        <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                            <li>Your employer/client withholds PAYE tax from your salary each month</li>
                            <li>This is advance payment of your annual income tax</li>
                            <li>PAYE is calculated using progressive tax rates (same as PIT)</li>
                            <li>At year-end, you file a tax return to reconcile total tax owed</li>
                            <li>If PAYE > actual tax owed, you get a refund</li>
                            <li>If PAYE < actual tax owed, you pay the difference</li>
                        </ul>
                    </div>

                    <!-- Export Buttons -->
                    <div class="export-buttons">
                        <button class="btn-export" onclick="exportPAYEtoPDF()">
                            üìÑ Download PAYE Report
                        </button>
                        <button class="btn-export" onclick="exportPAYEtoExcel()">
                            üìä Export PAYE Schedule
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
    // ==================== GLOBAL VARIABLES ====================

    // App State
    let currentUser = null;
    let currentMode = 'annual';
    let currentMonth = 1;
    let monthlyData = {};

    // FX Rate Management
    let currentExchangeRate = 1650;
    let lastRateFetch = null;
    const RATE_CACHE_DURATION = 3600000; // 1 hour

    // Constants
    const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 
                        'July', 'August', 'September', 'October', 'November', 'December'];

    // Tax Brackets Configuration (DRY principle)
    const TAX_BRACKETS = [
        { min: 0, max: 800000, rate: 0.00 },
        { min: 800000, max: 3000000, rate: 0.15 },
        { min: 3000000, max: 12000000, rate: 0.18 },
        { min: 12000000, max: 25000000, rate: 0.21 },
        { min: 25000000, max: 50000000, rate: 0.23 },
        { min: 50000000, max: Infinity, rate: 0.25 }
    ];

    // ==================== SECTION 1: AUTHENTICATION ====================

    function showHome() {
        document.getElementById('homePage').style.display = 'block';
        document.getElementById('loginPage').classList.remove('active');
        document.getElementById('signupPage').classList.remove('active');
        document.getElementById('dashboardPage').classList.remove('active');
    }

    function showLogin() {
        document.getElementById('homePage').style.display = 'none';
        document.getElementById('loginPage').classList.add('active');
        document.getElementById('signupPage').classList.remove('active');
        document.getElementById('dashboardPage').classList.remove('active');
    }

    function showSignup() {
        document.getElementById('homePage').style.display = 'none';
        document.getElementById('loginPage').classList.remove('active');
        document.getElementById('signupPage').classList.add('active');
        document.getElementById('dashboardPage').classList.remove('active');
    }

    function showQuickCalc() {
        alert('Quick calculator coming soon! For now, please sign up to access all features.');
        showSignup();
    }

    function handleLogin(event) {
        event.preventDefault();
        
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;
        
        // Simulate login (In production: API call)
        const storedUser = localStorage.getItem('taxnaija_user_' + email);
        
        if (storedUser) {
            currentUser = JSON.parse(storedUser);
            loadUserData();
            showDashboard();
        } else {
            alert('Account not found. Please sign up first.');
        }
    }

    function handleSignup(event) {
        event.preventDefault();
        
        const name = document.getElementById('signupName').value;
        const email = document.getElementById('signupEmail').value;
        const password = document.getElementById('signupPassword').value;
        const businessType = document.getElementById('signupBusinessType').value;
        
        // Create user object
        currentUser = {
            name: name,
            email: email,
            businessType: businessType,
            createdAt: new Date().toISOString()
        };
        
        // Save to localStorage
        localStorage.setItem('taxnaija_user_' + email, JSON.stringify(currentUser));
        localStorage.setItem('taxnaija_current_user', email);
        
        // Show dashboard
        monthlyData = {};
        showDashboard();
    }

    function loginWithGoogle() {
        alert('Google login coming soon! For now, please use email/password signup.');
    }

    function signupWithGoogle() {
        alert('Google signup coming soon! For now, please use email/password signup.');
    }

    function handleLogout() {
        if (confirm('Are you sure you want to logout?')) {
            currentUser = null;
            monthlyData = {};
            localStorage.removeItem('taxnaija_current_user');
            showHome();
        }
    }

    function showDashboard() {
        document.getElementById('homePage').style.display = 'none';
        document.getElementById('loginPage').classList.remove('active');
        document.getElementById('signupPage').classList.remove('active');
        document.getElementById('dashboardPage').classList.add('active');
        
        // Update user info
        document.getElementById('userName').textContent = currentUser.name;
        document.getElementById('userAvatar').textContent = currentUser.name.charAt(0).toUpperCase();
        
        // Check business type for PAYE
        checkBusinessTypeForPAYE();
        
        // Show FX converter if remote worker
        checkBusinessType();
        
        // Update navigation
        document.getElementById('navAuthLink').textContent = 'Dashboard';
        document.getElementById('navAuthLink').onclick = () => {}; // Remove login action
        document.getElementById('navCTABtn').textContent = 'Logout';
        document.getElementById('navCTABtn').onclick = handleLogout;
    }

    // ==================== SECTION 2: TAX ENGINE ====================

    // Calculate tax amount using progressive brackets
    function calculateTaxAmount(income) {
        // Prevent negative income
        if (income < 0) income = 0;
        
        let tax = 0;
        
        TAX_BRACKETS.forEach((bracket) => {
            if (income > bracket.min) {
                const taxableInBracket = Math.min(income, bracket.max) - bracket.min;
                tax += taxableInBracket * bracket.rate;
            }
        });
        
        return Math.round(tax);
    }

    // Get tax breakdown for display
    function getTaxBreakdown(income) {
        const breakdown = [];
        
        TAX_BRACKETS.forEach((bracket) => {
            if (income > bracket.min) {
                const taxableInBracket = Math.min(income, bracket.max) - bracket.min;
                const taxForBracket = taxableInBracket * bracket.rate;
                
                breakdown.push({
                    range: `‚Ç¶${formatNumber(bracket.min)} - ‚Ç¶${bracket.max === Infinity ? '‚àû' : formatNumber(bracket.max)}`,
                    rate: `${(bracket.rate * 100).toFixed(0)}%`,
                    taxable: taxableInBracket,
                    tax: taxForBracket
                });
            }
        });
        
        return breakdown;
    }

    // ==================== SECTION 3: PAYE CALCULATOR ====================

    function checkBusinessTypeForPAYE() {
        const payeWarning = document.getElementById('payeBusinessTypeWarning');
        const currentBusinessTypeEl = document.getElementById('currentBusinessType');
        const payeFxConverter = document.getElementById('payeFxConverter');
        
        if (currentUser) {
            currentBusinessTypeEl.textContent = currentUser.businessType;
            
            // Show warning if not salary/remote
            if (currentUser.businessType !== 'salary' && currentUser.businessType !== 'remote') {
                payeWarning.style.display = 'block';
            } else {
                payeWarning.style.display = 'none';
            }
            
            // Show FX converter for remote workers only
            if (currentUser.businessType === 'remote') {
                payeFxConverter.style.display = 'block';
                // Fetch exchange rate
                if (!lastRateFetch || (Date.now() - lastRateFetch > RATE_CACHE_DURATION)) {
                    fetchExchangeRate();
                }
            } else {
                payeFxConverter.style.display = 'none';
            }
        }
    }

    function convertPayeUSDtoNGN() {
        const usdInput = document.getElementById('payeUsdInput');
        const ngnOutput = document.getElementById('payeNgnOutput');
        const monthlyIncomeInput = document.getElementById('payeMonthlyIncome');
        
        if (!usdInput || !ngnOutput) return;
        
        const usdAmount = getNumberValue(usdInput);
        if (usdAmount > 0) {
            const ngnAmount = usdAmount * currentExchangeRate;
            ngnOutput.value = ngnAmount.toLocaleString('en-US', {maximumFractionDigits: 0});
            
            // Auto-fill monthly income
            if (monthlyIncomeInput) {
                monthlyIncomeInput.value = ngnAmount.toLocaleString('en-US', {maximumFractionDigits: 0});
            }
        } else {
            ngnOutput.value = '';
            if (monthlyIncomeInput) {
                monthlyIncomeInput.value = '';
            }
        }
    }

    function calculatePAYE() {
        const monthlyIncomeInput = document.getElementById('payeMonthlyIncome');
        const monthlyIncome = getNumberValue(monthlyIncomeInput);
        
        if (monthlyIncome === 0) {
            alert('Please enter your monthly income');
            return;
        }
        
        // Prevent negative income
        if (monthlyIncome < 0) {
            alert('Income cannot be negative. Please enter a valid amount.');
            return;
        }
        
        // Annualize income
        const annualIncome = monthlyIncome * 12;
        
        // Calculate annual tax using progressive brackets
        const annualTax = calculateTaxAmount(annualIncome);
        
        // Calculate monthly PAYE
        const monthlyPAYE = annualTax / 12;
        
        // Calculate net income
        const monthlyNet = monthlyIncome - monthlyPAYE;
        const annualNet = annualIncome - annualTax;
        
        // Calculate effective tax rate
        const effectiveRate = (annualTax / annualIncome * 100).toFixed(2);
        
        // Update summary cards
        document.getElementById('paye-monthly-gross').textContent = formatCurrency(monthlyIncome);
        document.getElementById('paye-monthly-tax').textContent = formatCurrency(monthlyPAYE);
        document.getElementById('paye-monthly-net').textContent = formatCurrency(monthlyNet);
        document.getElementById('paye-annual-tax').textContent = formatCurrency(annualTax);
        
        // Update annual summary
        document.getElementById('paye-annual-gross').textContent = formatCurrency(annualIncome);
        document.getElementById('paye-annual-tax-2').textContent = formatCurrency(annualTax);
        document.getElementById('paye-annual-net').textContent = formatCurrency(annualNet);
        document.getElementById('paye-effective-rate').textContent = effectiveRate + '%';
        
        // Generate monthly schedule
        generatePAYESchedule(monthlyIncome, monthlyPAYE, monthlyNet);
        
        // Update totals
        document.getElementById('paye-total-gross').textContent = formatCurrency(annualIncome);
        document.getElementById('paye-total-tax').textContent = formatCurrency(annualTax);
        document.getElementById('paye-total-net').textContent = formatCurrency(annualNet);
        
        // Show results
        document.getElementById('payeResults').classList.remove('hidden');
        
        // Scroll to results
        setTimeout(() => {
            document.getElementById('payeResults').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
    }

    function generatePAYESchedule(monthlyIncome, monthlyPAYE, monthlyNet) {
        const tbody = document.getElementById('payeScheduleBody');
        tbody.innerHTML = '';
        
        monthNames.forEach((month, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td style="padding: 12px; border: 1px solid #ddd;">${month} 2026</td>
                <td style="padding: 12px; text-align: right; border: 1px solid #ddd; font-weight: 600;">${formatCurrency(monthlyIncome)}</td>
                <td style="padding: 12px; text-align: right; border: 1px solid #ddd; font-weight: 600; color: var(--danger);">${formatCurrency(monthlyPAYE)}</td>
                <td style="padding: 12px; text-align: right; border: 1px solid #ddd; font-weight: 600; color: var(--accent);">${formatCurrency(monthlyNet)}</td>
            `;
            tbody.appendChild(row);
        });
    }

    // ==================== SECTION 4: MONTHLY TRACKER ====================

    function selectMonth(month) {
        currentMonth = month;
        
        // Update active button
        document.querySelectorAll('.month-btn').forEach((btn, index) => {
            if (index === month - 1) {
                btn.classList.add('active');
            } else {
                btn.classList.remove('active');
            }
        });
        
        // Update month name displays
        document.getElementById('currentMonthName').textContent = monthNames[month - 1];
        document.getElementById('currentMonthName2').textContent = monthNames[month - 1];
        
        // Load month data if exists
        if (monthlyData[month]) {
            document.getElementById('monthIncome').value = formatNumber(monthlyData[month].income);
            document.getElementById('monthExpenses').value = formatNumber(monthlyData[month].expenses);
        } else {
            document.getElementById('monthIncome').value = '';
            document.getElementById('monthExpenses').value = '';
        }
    }

    function saveMonth() {
        const incomeInput = document.getElementById('monthIncome');
        const expensesInput = document.getElementById('monthExpenses');
        
        const income = getNumberValue(incomeInput);
        const expenses = getNumberValue(expensesInput);
        
        if (income === 0) {
            alert('Please enter income for this month');
            return;
        }
        
        // Prevent negative values
        if (income < 0 || expenses < 0) {
            alert('Income and expenses cannot be negative. Please enter valid amounts.');
            return;
        }
        
        // Prevent expenses > income (negative profit warning)
        if (expenses > income) {
            if (!confirm('Warning: Your expenses exceed your income for this month. This will result in negative profit. Continue anyway?')) {
                return;
            }
        }
        
        const profit = income - expenses;

        monthlyData[currentMonth] = {
            income: income,
            expenses: expenses,
            profit: profit
        };
        
        saveUserData();
        updateMonthlyDisplay();
        
        // Mark month as completed
        document.querySelectorAll('.month-btn')[currentMonth - 1].classList.add('completed');
        
        alert(`${monthNames[currentMonth - 1]} data saved successfully!`);
    }

    function clearMonth() {
        if (confirm(`Are you sure you want to clear ${monthNames[currentMonth - 1]} data? This cannot be undone.`)) {
            delete monthlyData[currentMonth];
            
            document.getElementById('monthIncome').value = '';
            document.getElementById('monthExpenses').value = '';
            
            // Clear FX converter if visible
            const usdInput = document.getElementById('usdIncomeInput');
            const ngnInput = document.getElementById('ngnEquivalentInput');
            if (usdInput) usdInput.value = '';
            if (ngnInput) ngnInput.value = '';
            
            saveUserData();
            updateMonthlyDisplay();
            
            document.querySelectorAll('.month-btn')[currentMonth - 1].classList.remove('completed');
            
            alert(`${monthNames[currentMonth - 1]} data has been cleared.`);
        }
    }

    function updateMonthlyDisplay() {
        let totalIncome = 0;
        let totalExpenses = 0;
        let totalProfit = 0;
        let monthsEntered = 0;

        Object.values(monthlyData).forEach(month => {
            totalIncome += month.income;
            totalExpenses += month.expenses;
            totalProfit += month.profit;
            monthsEntered++;
        });

        if (monthsEntered > 0) {
            document.getElementById('ytdStats').classList.remove('hidden');
            document.getElementById('ytd-income').textContent = formatCurrency(totalIncome);
            document.getElementById('ytd-expenses').textContent = formatCurrency(totalExpenses);
            document.getElementById('ytd-profit').textContent = formatCurrency(totalProfit);

            // Project annual
            const avgMonthlyProfit = totalProfit / monthsEntered;
            const projectedAnnualProfit = avgMonthlyProfit * 12;
            
            // Calculate tax directly on profit (no CRA!)
            const tax = calculateTaxAmount(projectedAnnualProfit);
            
            const monthlyTarget = tax / 12;
            const savedSoFar = monthlyTarget * monthsEntered;

            document.getElementById('ytd-saved').textContent = formatCurrency(savedSoFar);
            document.getElementById('monthly-target').textContent = formatCurrency(monthlyTarget);
            document.getElementById('projected-tax').textContent = formatCurrency(tax);
        }
    }

    // ==================== SECTION 5: ANNUAL CALCULATOR ====================

    function calculateAnnualTax() {
        const incomeInput = document.getElementById('annualIncome');
        const expensesInput = document.getElementById('annualExpenses');
        
        const income = getNumberValue(incomeInput);
        const expenses = getNumberValue(expensesInput);
        
        if (income === 0) {
            alert('Please enter your annual income');
            return;
        }
        
        // Prevent negative values
        if (income < 0 || expenses < 0) {
            alert('Income and expenses cannot be negative. Please enter valid amounts.');
            return;
        }

        const profit = income - expenses;
        
        // Warn about negative profit
        if (profit < 0) {
            alert('Warning: Your expenses exceed your income. Resulting in negative profit of ' + formatCurrency(Math.abs(profit)) + '. No tax is owed on negative profit.');
        }

        // Calculate tax directly on profit
        const tax = calculateTaxAmount(Math.max(0, profit)); // Ensure non-negative for tax calc

        // Display results
        document.getElementById('calc-income').textContent = formatCurrency(income);
        document.getElementById('calc-expenses').textContent = formatCurrency(expenses);
        document.getElementById('calc-profit').textContent = formatCurrency(profit);
        document.getElementById('calc-tax').textContent = formatCurrency(tax);

        document.getElementById('annualResults').classList.remove('hidden');
        
        // Scroll to results
        setTimeout(() => {
            document.getElementById('annualResults').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
    }

    // ==================== SECTION 6: TAX PLANNER ====================

    function createPlan() {
        const incomeInput = document.getElementById('planIncome');
        const expensesInput = document.getElementById('planExpenses');
        
        const income = getNumberValue(incomeInput);
        const expenses = getNumberValue(expensesInput);
        
        if (income === 0) {
            alert('Please enter expected annual income');
            return;
        }
        
        // Prevent negative values
        if (income < 0 || expenses < 0) {
            alert('Income and expenses cannot be negative. Please enter valid amounts.');
            return;
        }

        const profit = income - expenses;
        
        // Warn about negative profit
        if (profit < 0) {
            alert('Warning: Your expected expenses exceed your expected income. No tax planning needed for negative profit.');
            return;
        }
        
        // Calculate tax directly on profit
        const recommendedTax = calculateTaxAmount(profit);
        const monthlyTarget = recommendedTax / 12;

        let html = `
            <div class="alert alert-success" style="margin-top: 30px;">
                <h3 style="color: var(--primary); margin-bottom: 15px;">üéØ Your 2026 Tax Plan</h3>
                <p><strong>Expected Annual Profit:</strong> ${formatCurrency(profit)}</p>
                <p><strong>Projected Tax:</strong> ${formatCurrency(recommendedTax)}</p>
                <p><strong>Monthly Savings Target:</strong> ${formatCurrency(monthlyTarget)}</p>
            </div>

            <div style="background: white; padding: 30px; border-radius: 12px; margin-top: 30px;">
                <h3 style="color: var(--primary); margin-bottom: 20px;">üìÖ Monthly Breakdown</h3>
                <table style="width: 100%; border-collapse: collapse;">
                    <thead>
                        <tr style="background: var(--bg-light);">
                            <th style="padding: 12px; text-align: left; border: 1px solid #ddd;">Month</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Save This Month</th>
                            <th style="padding: 12px; text-align: right; border: 1px solid #ddd;">Total Saved</th>
                        </tr>
                    </thead>
                    <tbody>
        `;

        let cumulative = 0;
        for (let i = 0; i < 12; i++) {
            cumulative += monthlyTarget;
            html += `
                <tr>
                    <td style="padding: 12px; border: 1px solid #ddd;">${monthNames[i]} 2026</td>
                    <td style="padding: 12px; text-align: right; border: 1px solid #ddd; font-weight: 600;">${formatCurrency(monthlyTarget)}</td>
                    <td style="padding: 12px; text-align: right; border: 1px solid #ddd; color: var(--primary); font-weight: 700;">${formatCurrency(cumulative)}</td>
                </tr>
            `;
        }

        html += `
                    </tbody>
                </table>
            </div>

            <div class="alert alert-info" style="margin-top: 30px;">
                <strong>üí° Pro Tip:</strong> Open a separate savings account and transfer ${formatCurrency(monthlyTarget)} 
                every month automatically. By March 2027, you'll have ${formatCurrency(recommendedTax)} ready for tax filing with zero stress!
            </div>
        `;

        document.getElementById('planResults').innerHTML = html;
        document.getElementById('planResults').classList.remove('hidden');
    }

    // ==================== SECTION 7: UI HELPERS ====================

    function selectMode(mode) {
        currentMode = mode;
        
        // Update active mode card
        document.querySelectorAll('.mode-card').forEach(card => {
            card.classList.remove('active');
        });
        document.getElementById(mode + 'Mode').classList.add('active');
        
        // Hide all calculator sections
        document.getElementById('annualCalculator').classList.add('hidden');
        document.getElementById('monthlyTracker').classList.add('hidden');
        document.getElementById('smartPlanner').classList.add('hidden');
        document.getElementById('payeCalculator').classList.add('hidden');
        
        // Show selected section
        if (mode === 'annual') {
            document.getElementById('annualCalculator').classList.remove('hidden');
        } else if (mode === 'monthly') {
            document.getElementById('monthlyTracker').classList.remove('hidden');
            checkBusinessType();
        } else if (mode === 'planner') {
            document.getElementById('smartPlanner').classList.remove('hidden');
        } else if (mode === 'paye') {
            document.getElementById('payeCalculator').classList.remove('hidden');
            checkBusinessTypeForPAYE();
        }
    }

    function formatNumberInput(input) {
        let value = input.value.replace(/,/g, '');
        if (value && !isNaN(value)) {
            // Prevent negative numbers
            if (parseFloat(value) < 0) {
                value = '0';
            }
            value = parseFloat(value).toLocaleString('en-US', {maximumFractionDigits: 2});
            input.value = value;
        }
    }

    function getNumberValue(input) {
        if (!input) return 0;
        const value = input.value.replace(/,/g, '');
        const num = parseFloat(value) || 0;
        // Ensure non-negative
        return Math.max(0, num);
    }

    function formatCurrency(amount) {
        return '‚Ç¶' + Math.round(amount).toLocaleString('en-NG');
    }

    function formatNumber(amount) {
        return Math.round(amount).toLocaleString('en-NG');
    }

    function toggleMobileMenu() {
        const navMenu = document.getElementById('navMenu');
        const burger = document.querySelector('.burger-menu');
        
        if (navMenu && burger) {
            navMenu.classList.toggle('active');
            burger.classList.toggle('active');
        }
    }

    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
        const navMenu = document.getElementById('navMenu');
        const burger = document.querySelector('.burger-menu');
        
        if (navMenu && burger && !event.target.closest('.nav-container')) {
            navMenu.classList.remove('active');
            burger.classList.remove('active');
        }
    });

    // ==================== SECTION 8: FX CONVERTER ====================

    function checkBusinessType() {
        if (!currentUser) return;
        
        const fxSection = document.getElementById('fxConverterSection');
        if (fxSection) {
            if (currentUser.businessType === 'remote') {
                fxSection.style.display = 'block';
                if (!lastRateFetch || (Date.now() - lastRateFetch > RATE_CACHE_DURATION)) {
                    fetchExchangeRate();
                }
            } else {
                fxSection.style.display = 'none';
            }
        }
    }

    async function fetchExchangeRate() {
        const now = Date.now();
        if (lastRateFetch && (now - lastRateFetch < RATE_CACHE_DURATION)) {
            console.log('Using cached exchange rate');
            return;
        }
        
        const loadingBadge = document.getElementById('fxLoadingBadge');
        const rateElement = document.getElementById('currentExchangeRate');
        const rateSourceElement = document.getElementById('rateSource');
        const payeRateElement = document.getElementById('payeExchangeRate');
        const payeRateSource = document.getElementById('payeRateSource');
        
        if (loadingBadge) loadingBadge.textContent = '(Updating...)';
        
        try {
            const response = await fetch('https://api.exchangerate-api.com/v4/latest/USD');
            
            if (!response.ok) {
                throw new Error('API request failed');
            }
            
            const data = await response.json();
            const officialRate = data.rates.NGN;
            const blackMarketRate = Math.round(officialRate * 1.03);
            
            currentExchangeRate = blackMarketRate;
            lastRateFetch = now;
            
            if (rateElement) rateElement.textContent = blackMarketRate;
            if (payeRateElement) payeRateElement.textContent = blackMarketRate;
            
            if (rateSourceElement) {
                rateSourceElement.textContent = 'Live Rate';
                rateSourceElement.style.background = 'rgba(46, 213, 115, 0.3)';
            }
            if (payeRateSource) {
                payeRateSource.textContent = 'Live Rate';
                payeRateSource.style.background = 'rgba(46, 213, 115, 0.3)';
            }
            
            if (loadingBadge) {
                loadingBadge.textContent = '(Updated)';
                setTimeout(() => {
                    if (loadingBadge) loadingBadge.textContent = '';
                }, 2000);
            }
            
            localStorage.setItem('lastExchangeRate', blackMarketRate);
            localStorage.setItem('lastRateFetch', now);
            
            const usdInput = document.getElementById('usdIncomeInput');
            if (usdInput && usdInput.value) {
                convertUSDtoNGN();
            }
            
            const payeUsdInput = document.getElementById('payeUsdInput');
            if (payeUsdInput && payeUsdInput.value) {
                convertPayeUSDtoNGN();
            }
            
        } catch (error) {
            console.error('Failed to fetch exchange rate:', error);
            
            const cachedRate = localStorage.getItem('lastExchangeRate');
            if (cachedRate) {
                currentExchangeRate = parseFloat(cachedRate);
                if (rateElement) rateElement.textContent = currentExchangeRate;
                if (payeRateElement) payeRateElement.textContent = currentExchangeRate;
                if (rateSourceElement) {
                    rateSourceElement.textContent = 'Cached';
                    rateSourceElement.style.background = 'rgba(255, 193, 7, 0.3)';
                }
                if (payeRateSource) {
                    payeRateSource.textContent = 'Cached';
                    payeRateSource.style.background = 'rgba(255, 193, 7, 0.3)';
                }
            }
            
            if (loadingBadge) {
                loadingBadge.textContent = '(Offline Mode)';
            }
        }
    }

    function refreshExchangeRate() {
        lastRateFetch = null;
        fetchExchangeRate();
    }

    function convertUSDtoNGN() {
        const usdInput = document.getElementById('usdIncomeInput');
        const ngnInput = document.getElementById('ngnEquivalentInput');
        
        if (!usdInput || !ngnInput) return;
        
        const usdAmount = getNumberValue(usdInput);
        if (usdAmount > 0) {
            const ngnAmount = usdAmount * currentExchangeRate;
            ngnInput.value = ngnAmount.toLocaleString('en-US', {maximumFractionDigits: 0});
            
            const monthIncomeInput = document.getElementById('monthIncome');
            if (monthIncomeInput) {
                monthIncomeInput.value = ngnAmount.toLocaleString('en-US', {maximumFractionDigits: 0});
            }
        } else {
            ngnInput.value = '';
            const monthIncomeInput = document.getElementById('monthIncome');
            if (monthIncomeInput) {
                monthIncomeInput.value = '';
            }
        }
    }

    // ==================== SECTION 9: DISCLAIMER ====================

    function showDisclaimerModal() {
        document.getElementById('disclaimerModal').style.display = 'block';
        document.body.style.overflow = 'hidden';
    }

    function acceptDisclaimer() {
        localStorage.setItem('taxnaija_disclaimer_accepted', 'true');
        document.getElementById('disclaimerModal').style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    // Enable accept button when checkbox is checked
    document.addEventListener('change', function(event) {
        if (event.target.id === 'disclaimerAccept') {
            const acceptBtn = document.getElementById('acceptDisclaimerBtn');
            if (event.target.checked) {
                acceptBtn.disabled = false;
                acceptBtn.style.cursor = 'pointer';
                acceptBtn.style.opacity = '1';
            } else {
                acceptBtn.disabled = true;
                acceptBtn.style.cursor = 'not-allowed';
                acceptBtn.style.opacity = '0.5';
            }
        }
    });

    // Show disclaimer on first visit
    document.addEventListener('DOMContentLoaded', function() {
        const disclaimerAccepted = localStorage.getItem('taxnaija_disclaimer_accepted');
        if (!disclaimerAccepted) {
            setTimeout(() => {
                showDisclaimerModal();
            }, 1000);
        }
        
        // Update countdown
        updateCountdown();
        setInterval(updateCountdown, 3600000);
        
        // Try to load cached exchange rate
        const cachedRate = localStorage.getItem('lastExchangeRate');
        if (cachedRate) {
            currentExchangeRate = parseFloat(cachedRate);
        }
        
        // Auto-login if session exists
        const currentUserEmail = localStorage.getItem('taxnaija_current_user');
        if (currentUserEmail) {
            const storedUser = localStorage.getItem('taxnaija_user_' + currentUserEmail);
            if (storedUser) {
                currentUser = JSON.parse(storedUser);
                loadUserData();
                showDashboard();
            }
        }
    });

    // ==================== SECTION 10: EXPORT FUNCTIONS ====================

    function exportToPDF() {
        if (typeof window.jspdf === 'undefined') {
            alert('PDF library not loaded. Please refresh the page and try again.');
            return;
        }
        
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        const income = getNumberValue(document.getElementById('annualIncome'));
        const expenses = getNumberValue(document.getElementById('annualExpenses'));
        const profit = Math.max(0, income - expenses);
        const tax = calculateTaxAmount(profit);
        
        // Header
        doc.setFontSize(20);
        doc.setTextColor(0, 107, 61);
        doc.text('TaxNaija - 2026 Tax Report', 20, 20);
        
        // User Info
        doc.setFontSize(12);
        doc.setTextColor(0, 0, 0);
        doc.text(`User: ${currentUser.name}`, 20, 35);
        doc.text(`Business Type: ${currentUser.businessType}`, 20, 42);
        doc.text(`Generated: ${new Date().toLocaleDateString()}`, 20, 49);
        
        doc.setLineWidth(0.5);
        doc.line(20, 55, 190, 55);
        
        // Income Summary
        doc.setFontSize(14);
        doc.text('Income Summary:', 20, 70);
        
        doc.setFontSize(11);
        doc.text(`Gross Income: ‚Ç¶${income.toLocaleString()}`, 30, 80);
        doc.text(`Business Expenses: ‚Ç¶${expenses.toLocaleString()}`, 30, 87);
        doc.text(`Net Profit: ‚Ç¶${profit.toLocaleString()}`, 30, 94);
        
        // Tax Brackets
        doc.setFontSize(14);
        doc.text('Tax Calculation:', 20, 110);
        
        doc.setFontSize(11);
        doc.text('Progressive Tax Brackets Applied:', 30, 120);
        doc.text('‚Ä¢ ‚Ç¶0 - ‚Ç¶800,000: 0% tax', 35, 127);
        doc.text('‚Ä¢ ‚Ç¶800,001 - ‚Ç¶3,000,000: 15% tax', 35, 134);
        doc.text('‚Ä¢ ‚Ç¶3,000,001 - ‚Ç¶12,000,000: 18% tax', 35, 141);
        doc.text('‚Ä¢ ‚Ç¶12,000,001 - ‚Ç¶25,000,000: 21% tax', 35, 148);
        doc.text('‚Ä¢ ‚Ç¶25,000,001 - ‚Ç¶50,000,000: 23% tax', 35, 155);
        doc.text('‚Ä¢ Above ‚Ç¶50,000,000: 25% tax', 35, 162);
        
        // Total Tax
        doc.setFontSize(16);
        doc.setFillColor(0, 107, 61);
        doc.rect(20, 175, 170, 15, 'F');
        doc.setTextColor(255, 255, 255);
        doc.text(`Total Tax for 2026: ‚Ç¶${tax.toLocaleString()}`, 25, 184);
        
        // Disclaimer
        doc.setFontSize(9);
        doc.setTextColor(230, 57, 70);
        doc.text('DISCLAIMER: This is an estimate only. Consult FIRS or a licensed tax professional.', 20, 270);
        
        // Footer
        doc.setFontSize(10);
        doc.setTextColor(100, 100, 100);
        doc.text('Generated by TaxNaija - Educational purposes only', 20, 280);
        
        doc.save(`TaxNaija_Report_${currentUser.name}_${Date.now()}.pdf`);
    }

    function exportToExcel() {
        if (typeof XLSX === 'undefined') {
            alert('Excel library not loaded. Please refresh the page and try again.');
            return;
        }
        
        const income = getNumberValue(document.getElementById('annualIncome'));
        const expenses = getNumberValue(document.getElementById('annualExpenses'));
        const profit = Math.max(0, income - expenses);
        const tax = calculateTaxAmount(profit);
        
        const data = [
            ['TaxNaija - 2026 Tax Report'],
            [],
            ['User Information'],
            ['Name:', currentUser.name],
            ['Email:', currentUser.email],
            ['Business Type:', currentUser.businessType],
            ['Generated:', new Date().toLocaleDateString()],
            [],
            ['Income Summary'],
            ['Gross Income:', income],
            ['Business Expenses:', expenses],
            ['Net Profit:', profit],
            [],
            ['Tax Calculation'],
            ['Taxable Profit:', profit],
            ['Tax Owed (2026):', tax],
            [],
            ['Tax Brackets Applied'],
            ['‚Ç¶0 - ‚Ç¶800,000', '0%'],
            ['‚Ç¶800,001 - ‚Ç¶3,000,000', '15%'],
            ['‚Ç¶3,000,001 - ‚Ç¶12,000,000', '18%'],
            ['‚Ç¶12,000,001 - ‚Ç¶25,000,000', '21%'],
            ['‚Ç¶25,000,001 - ‚Ç¶50,000,000', '23%'],
            ['Above ‚Ç¶50,000,000', '25%'],
            [],
            ['DISCLAIMER'],
            ['This is an estimate only. Consult FIRS or a licensed tax professional for official filing.']
        ];
        
        if (Object.keys(monthlyData).length > 0) {
            data.push([]);
            data.push(['Monthly Breakdown']);
            data.push(['Month', 'Income', 'Expenses', 'Profit']);
            
            Object.entries(monthlyData).forEach(([month, monthData]) => {
                data.push([
                    monthNames[month - 1],
                    monthData.income,
                    monthData.expenses,
                    monthData.profit
                ]);
            });
        }
        
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet(data);
        
        XLSX.utils.book_append_sheet(wb, ws, 'Tax Report');
        
        XLSX.writeFile(wb, `TaxNaija_Report_${currentUser.name}_${Date.now()}.xlsx`);
    }

    function exportPAYEtoPDF() {
        if (typeof window.jspdf === 'undefined') {
            alert('PDF library not loaded. Please refresh the page and try again.');
            return;
        }
        
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        const monthlyIncome = getNumberValue(document.getElementById('payeMonthlyIncome'));
        const annualIncome = monthlyIncome * 12;
        const annualTax = calculateTaxAmount(annualIncome);
        const monthlyPAYE = annualTax / 12;
        
        // Header
        doc.setFontSize(20);
        doc.setTextColor(0, 107, 61);
        doc.text('TaxNaija - PAYE Report 2026', 20, 20);
        
        // User Info
        doc.setFontSize(12);
        doc.setTextColor(0, 0, 0);
        doc.text(`User: ${currentUser.name}`, 20, 35);
        doc.text(`Business Type: ${currentUser.businessType}`, 20, 42);
        doc.text(`Generated: ${new Date().toLocaleDateString()}`, 20, 49);
        
        doc.setLineWidth(0.5);
        doc.line(20, 55, 190, 55);
        
        // Summary
        doc.setFontSize(14);
        doc.text('PAYE Summary:', 20, 70);
        
        doc.setFontSize(11);
        doc.text(`Monthly Gross Salary: ‚Ç¶${monthlyIncome.toLocaleString()}`, 30, 80);
        doc.text(`Monthly PAYE Tax: ‚Ç¶${monthlyPAYE.toLocaleString()}`, 30, 87);
        doc.text(`Monthly Net (Take Home): ‚Ç¶${(monthlyIncome - monthlyPAYE).toLocaleString()}`, 30, 94);
        doc.text(`Annual Income: ‚Ç¶${annualIncome.toLocaleString()}`, 30, 104);
        doc.text(`Annual Tax: ‚Ç¶${annualTax.toLocaleString()}`, 30, 111);
        
        // Disclaimer
        doc.setFontSize(9);
        doc.setTextColor(230, 57, 70);
        doc.text('DISCLAIMER: This is an estimate only. Consult FIRS or a licensed tax professional.', 20, 270);
        
        // Footer
        doc.setFontSize(10);
        doc.setTextColor(100, 100, 100);
        doc.text('Generated by TaxNaija - Educational purposes only', 20, 280);
        
        doc.save(`TaxNaija_PAYE_Report_${currentUser.name}_${Date.now()}.pdf`);
    }

    function exportPAYEtoExcel() {
        if (typeof XLSX === 'undefined') {
            alert('Excel library not loaded. Please refresh the page and try again.');
            return;
        }
        
        const monthlyIncome = getNumberValue(document.getElementById('payeMonthlyIncome'));
        const annualIncome = monthlyIncome * 12;
        const annualTax = calculateTaxAmount(annualIncome);
        const monthlyPAYE = annualTax / 12;
        const monthlyNet = monthlyIncome - monthlyPAYE;
        
        const data = [
            ['TaxNaija - PAYE Report 2026'],
            [],
            ['User Information'],
            ['Name:', currentUser.name],
            ['Business Type:', currentUser.businessType],
            ['Generated:', new Date().toLocaleDateString()],
            [],
            ['PAYE Summary'],
            ['Monthly Gross Salary:', monthlyIncome],
            ['Monthly PAYE Tax:', monthlyPAYE],
            ['Monthly Net Income:', monthlyNet],
            ['Annual Gross Income:', annualIncome],
            ['Annual Tax:', annualTax],
            [],
            ['Monthly Schedule'],
            ['Month', 'Gross Income', 'PAYE Tax', 'Net Income']
        ];
        
        monthNames.forEach(month => {
            data.push([month, monthlyIncome, monthlyPAYE, monthlyNet]);
        });
        
        data.push([]);
        data.push(['DISCLAIMER']);
        data.push(['This is an estimate only. Consult FIRS or a licensed tax professional for official filing.']);
        
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet(data);
        
        XLSX.utils.book_append_sheet(wb, ws, 'PAYE Report');
        
        XLSX.writeFile(wb, `TaxNaija_PAYE_Report_${currentUser.name}_${Date.now()}.xlsx`);
    }

    // ==================== SECTION 11: DATA PERSISTENCE ====================

    function saveUserData() {
        if (currentUser) {
            localStorage.setItem('taxnaija_data_' + currentUser.email, JSON.stringify(monthlyData));
        }
    }

    function loadUserData() {
        if (currentUser) {
            const data = localStorage.getItem('taxnaija_data_' + currentUser.email);
            if (data) {
                monthlyData = JSON.parse(data);
                updateMonthlyDisplay();
            }
        }
    }

    // ==================== SECTION 12: COUNTDOWN TIMER ====================

    function updateCountdown() {
        const deadline = new Date('2027-03-31T23:59:59');
        const now = new Date();
        const diff = deadline - now;
        
        const countdownEl = document.getElementById('daysRemaining');
        if (countdownEl) {
            if (diff > 0) {
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                countdownEl.textContent = days;
            } else {
                countdownEl.textContent = 'DEADLINE PASSED!';
                countdownEl.style.fontSize = '1.5em';
                countdownEl.style.color = 'var(--danger)';
            }
        }
    }

    </script>

    <!-- Legal Disclaimer Footer -->
        <footer style="background: #1A1A2E; color: white; padding: 40px 20px; margin-top: 80px;">
            <div style="max-width: 1200px; margin: 0 auto;">
                <!-- Main Disclaimer -->
                <div style="background: rgba(230, 57, 70, 0.1); border-left: 4px solid #E63946; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                    <h3 style="color: #E63946; margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                        ‚ö†Ô∏è Important Legal Disclaimer
                    </h3>
                    <p style="line-height: 1.8; opacity: 0.95;">
                        <strong>TaxNaija provides tax estimates and educational information only.</strong> 
                        The calculations provided are based on the Nigeria Tax Act 2025 and current FIRS guidelines, 
                        but are NOT official tax advice or filings.
                    </p>
                    <p style="line-height: 1.8; opacity: 0.95; margin-top: 10px;">
                        <strong>You MUST:</strong>
                    </p>
                    <ul style="margin-left: 20px; line-height: 2; opacity: 0.95;">
                        <li>Consult a licensed tax professional or chartered accountant for your specific situation</li>
                        <li>Verify all calculations with FIRS before filing</li>
                        <li>File official returns with FIRS by March 31, 2027</li>
                        <li>Keep proper documentation and receipts</li>
                        <li>Report any discrepancies to your tax advisor</li>
                    </ul>
                    <p style="line-height: 1.8; opacity: 0.95; margin-top: 10px;">
                        <strong>Limitation of Liability:</strong> TaxNaija, its creators, and operators are not responsible 
                        for any tax penalties, interest, or liabilities arising from the use of this calculator. 
                        Always seek professional advice for tax matters.
                    </p>
                </div>

                <!-- Quick Links -->
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 30px; margin-bottom: 30px;">
                    <div>
                        <h4 style="color: var(--secondary); margin-bottom: 15px;">Official Resources</h4>
                        <ul style="list-style: none; padding: 0; line-height: 2; opacity: 0.9;">
                            <li><a href="https://www.nrs.gov.ng" target="_blank" style="color: white; text-decoration: none;">üîó FIRS Official Website</a></li>
                            <li><a href="https://www.nrs.gov.ng/tax-resources" target="_blank" style="color: white; text-decoration: none;">üìö Tax Resources</a></li>
                            <li><a href="https://www.citn.org" target="_blank" style="color: white; text-decoration: none;">üë®‚Äçüíº Find Tax Consultant</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: var(--secondary); margin-bottom: 15px;">Support</h4>
                        <ul style="list-style: none; padding: 0; line-height: 2; opacity: 0.9;">
                            <li><a href="#" onclick="showDisclaimerModal()" style="color: white; text-decoration: none;">üìÑ Full Disclaimer</a></li>
                            <li><a href="#" style="color: white; text-decoration: none;">üìß Contact Support</a></li>
                            <li><a href="#" style="color: white; text-decoration: none;">üêõ Report Issue</a></li>
                        </ul>
                    </div>
                    <div>
                        <h4 style="color: var(--secondary); margin-bottom: 15px;">About</h4>
                        <ul style="list-style: none; padding: 0; line-height: 2; opacity: 0.9;">
                            <li>Version 1.0.0</li>
                            <li>Updated: Jan 2026</li>
                            <li>¬© 2025 TaxNaija</li>
                        </ul>
                    </div>
                </div>

                <!-- Copyright -->
                <div style="text-align: center; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); opacity: 0.8;">
                    <p>¬© 2025 TaxNaija. Educational purposes only. Not a substitute for professional tax advice.</p>
                </div>
            </div>
        </footer>

        <!-- Disclaimer Modal (First Visit) -->
        <div id="disclaimerModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; overflow-y: auto;">
            <div style="max-width: 600px; margin: 50px auto; background: white; border-radius: 15px; padding: 40px; position: relative;">
                <h2 style="color: var(--danger); margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                    ‚ö†Ô∏è Important Notice
                </h2>
                
                <p style="line-height: 1.8; margin-bottom: 15px;">
                    Before using TaxNaija, please understand:
                </p>
                
                <div style="background: var(--bg-light); padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <h3 style="color: var(--primary); margin-bottom: 15px;">‚úì What TaxNaija IS:</h3>
                    <ul style="line-height: 2;">
                        <li>An educational tax calculator</li>
                        <li>A planning and estimation tool</li>
                        <li>Based on Nigeria Tax Act 2025</li>
                        <li>Helpful for understanding tax obligations</li>
                    </ul>
                </div>
                
                <div style="background: rgba(230, 57, 70, 0.1); padding: 20px; border-radius: 10px; margin: 20px 0; border: 2px solid var(--danger);">
                    <h3 style="color: var(--danger); margin-bottom: 15px;">‚úó What TaxNaija IS NOT:</h3>
                    <ul style="line-height: 2;">
                        <li>NOT an official FIRS filing system</li>
                        <li>NOT a substitute for professional advice</li>
                        <li>NOT legal or financial advice</li>
                        <li>NOT responsible for any filing errors</li>
                    </ul>
                </div>
                
                <div style="background: var(--secondary); color: var(--primary-dark); padding: 15px; border-radius: 8px; margin: 20px 0; font-weight: 600;">
                    ‚ö†Ô∏è ALWAYS consult a licensed tax professional or FIRS before filing official returns!
                </div>
                
                <div style="display: flex; gap: 15px; margin-top: 30px;">
                    <label style="flex: 1; display: flex; align-items: center; gap: 10px; cursor: pointer;">
                        <input type="checkbox" id="disclaimerAccept" style="width: 20px; height: 20px;">
                        <span style="font-size: 0.95em;">I understand and accept the disclaimer</span>
                    </label>
                </div>
                
                <button onclick="acceptDisclaimer()" id="acceptDisclaimerBtn" disabled style="width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 8px; font-weight: 700; font-size: 1.1em; margin-top: 20px; cursor: not-allowed; opacity: 0.5;">
                    Continue to TaxNaija
                </button>
            </div>
        </div>

</body>
</html>
